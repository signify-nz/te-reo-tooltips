!function(e){function t(o){if(n[o])return n[o].exports;var i=n[o]={i:o,l:!1,exports:{}};return e[o].call(i.exports,i,i.exports,t),i.l=!0,i.exports}var n={};t.m=e,t.c=n,t.i=function(e){return e},t.d=function(e,n,o){t.o(e,n)||Object.defineProperty(e,n,{configurable:!1,enumerable:!0,get:o})},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,"a",n),n},t.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},t.p="",t(t.s="./client/src/js/TeReoPlugin.js")}({"./client/src/js/TeReoPlugin.js":function(e,t,n){"use strict";tinymce.PluginManager.add("TeReoPlugin",function(e,t){function n(e,t){var n=document.createElement("span");return e.parentNode.insertBefore(n,e),n.insertAdjacentHTML("beforebegin",t),n.remove(),e}function o(e){return e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#039;")}function i(e){return e?e.replace(/[.?*+^$[\]\\(){}|-]/g,"\\$&"):""}function a(e){for(var t="-%-%-",n=0;n<e.length;n++)t+=e.codePointAt(n)+"-";return t+="%-%-"}function r(e){var t=e.split("-%-%-").filter(Boolean);t=t[0].split("-");for(var n=[],o=0;o<t.length;o++)n[o]=String.fromCodePoint(t[o]);return n.join("")}function s(e){var t=!(arguments.length>1&&void 0!==arguments[1])||arguments[1],n="",o="",s="",c="";if(!e)return e;t?(n="[TT]",o="[/TT]"):(n='<span class="TeReoTooltip" style="text-decoration: underline 1px dashed;">',o="</span>",s="(?<![a-zA-Z0-9])(",c=")(?![/TT])(?![a-zA-Z0-9])(?![^<]*>)");var u=e;m.forEach(function(e,t){var r=i(t),l=new RegExp(s+r+c,"gi");u=u.replace(l,n+a(t)+o)});var l=new RegExp("(-%-%-).*?(-%-%-)","gi");return u=u.replace(l,function(e){return r(e)})}function c(t){var i=e.selection.getNode();1===i.nodeType&&(i=i.firstChild);var a=new tinymce.dom.TreeWalker(i),r=!1,c=!1,u=void 0;do{u&&(u.remove(),u=null);var l=a.current();if(l.isEqualNode(t.startContainer)&&l.isEqualNode(t.endContainer)&&3===l.nodeType)r=!1,u=n(l,o(l.nodeValue.substr(0,t.startOffset))+s(e.selection.getContent(),!1)+o(l.nodeValue.substr(t.endOffset)));else if(3===l.nodeType)if(l.isEqualNode(t.endContainer)&&r){var d=s(l.nodeValue.substr(0,t.endOffset),!1)+l.nodeValue.substr(t.endOffset);u=n(l,d),r=!1,c=!0}else if(r){var f=s(l.nodeValue,!1);u=n(l,f)}else if(l.isEqualNode(t.startContainer)){var p=l.nodeValue.substr(0,t.startOffset)+s(l.nodeValue.substr(t.startOffset),!1);u=n(l,p),r=!0}}while(a.next()&&!c);u&&u.remove(),e.selection.moveToBookmark(T)}function u(e,t,n){if(e&&t)if(m.has(e))tinymce.activeEditor.windowManager.alert("This word already has a translation! ("+m.get(e)+")");else{var o=new XMLHttpRequest;o.open("POST","/api/v1/dictionary/addWordPair/");var i=document.getElementsByName("SecurityID")[0],a=i.getAttribute("value");o.setRequestHeader("X-SecurityID",a);var r=JSON.stringify({dictionaryID:n,baseWord:e,destinationWord:t});o.send(r),o.onreadystatechange=function(){4===this.readyState&&200===this.status&&(m.set(e,t),tinymce.activeEditor.windowManager.close(),tinymce.activeEditor.windowManager.alert('Successfully added wordpair "'+e+'", "'+t+'".')),4===this.readyState&&400===this.status&&tinymce.activeEditor.windowManager.alert(this.response)}}else tinymce.activeEditor.windowManager.alert("Cannot submit an empty field!")}function l(t){var n=new XMLHttpRequest;n.open("POST","/api/v1/dictionary/translateThroughInterface",!0);var o=document.getElementsByName("SecurityID")[0],i=o.getAttribute("value");n.setRequestHeader("X-SecurityID",i),n.onreadystatechange=function(){4===this.readyState&&200===this.status&&(e.setContent(n.responseText,{format:"html"}),e.undoManager.add(),tinymce.activeEditor.selection.moveToBookmark(T))},n.send(t)}function d(e){var t=new XMLHttpRequest,n="/api/v1/dictionary/dictionaries/"+e;t.open("GET",n);var o=document.getElementsByName("SecurityID")[0],i=o.getAttribute("value");t.setRequestHeader("X-SecurityID",i),t.send(),t.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var e=t.responseText;e=JSON.parse(e);for(var n=0;n<e.length;n++)m.set(e[n].Base,e[n].Destination)}}}function f(){var e=new XMLHttpRequest;e.open("GET","/api/v1/dictionary/index/");var t=document.getElementsByName("SecurityID")[0],n=t.getAttribute("value");e.setRequestHeader("X-SecurityID",n),e.send(),e.onreadystatechange=function(){if(4===this.readyState&&200===this.status){var t=e.responseText;if(t){t=JSON.parse(t);for(var n=0;n<t.length;n++)h.push({text:t[n].Title,value:t[n].Title,id:t[n].ID})}}}}function p(e){var t=null;return e.replace(/(<span class="TeReoTooltip" style="text-decoration: underline 1px dashed;">)(.+?)(<\/span>)/g,function(e){return t=e.slice(74,e.length-7),m.forEach(function(n,o){o.toLowerCase()===e.slice(74,e.length-7).toLowerCase()&&(t="[TT]"+e.slice(74,e.length-7)+"[/TT]")}),t||(t=e.slice(74,e.length-7)),t})}function g(e){var t='<span class="TeReoTooltip" style="text-decoration: underline 1px dashed;">',n="";return e.replace(/\[TT([^\]]*)\]([^\]]*)\[\/TT\]/g,function(e){var o=e.includes("&#8203");return 0===m.size?(n=t+e.slice(4,e.length-5)+"</span>",o||(n+="&#8203"),n):(m.forEach(function(i,a){a.toLowerCase()===e.slice(4,e.length-5).toLowerCase()&&(n=t+e.slice(4,e.length-5)+"</span>",o||(n+="&#8203"))}),n||(n=e.slice(4,e.length-5)),n)})}function y(t){e.windowManager.open({layout:"flex",pack:"center",align:"center",onClose:function(){e.focus()},onSubmit:function(){},buttons:[{text:"Add",subtype:"primary",onclick:function(){var e=h.find(function(e){return e.text===document.getElementById("DictionaryDisplayComboBox-inp").value}).id;u(document.getElementById("BaseInputTextBox").value.replace(/[\u200B-\u200D\uFEFF]/g,""),document.getElementById("DestinationInputTextBox").value,e)}},{type:"spacer",flex:1}],title:"Add to Dictionary",items:{type:"form",padding:20,labelGap:30,spacing:10,items:[{type:"textbox",name:"Base",size:40,label:"Base",value:t.trim(),id:"BaseInputTextBox",tooltip:"An untranslated word"},{type:"textbox",name:"Destination",size:40,label:"Translation",id:"DestinationInputTextBox",tooltip:"A translated word"},{type:"combobox",name:"Dictionary",size:40,label:"Dictionary",id:"DictionaryDisplayComboBox",tooltip:"Select which dictionary you want to add to",values:h,onPostRender:function(){this.value(h[0].value)}}]}})}function v(){var t=this;e.on("MouseMove",function(){t.disabled(0===h.length)})}var m=new Map,h=[],T=void 0;e.on("init",function(){d(),f()}),e.on("BeforeSetcontent",function(e){e.content=g(e.content)}),e.on("GetContent",function(e){e.content=p(e.content)}),e.addMenuItem("addToDictionary",{text:"Add to Dictionary",onclick:function(){y(e.selection.getContent({format:"text"}))},onPostRender:v}),e.addButton("translate",{image:"/_resources/vendor/signify-nz/te-reo-tooltips/client/dist/img/globe-light.svg",tooltip:"Translate content",onclick:function(){T=tinymce.activeEditor.selection.getBookmark(2,!0),e.undoManager.add(),l(e.getContent()),tinymce.activeEditor.fire("change")},onPostRender:v}),e.addMenuItem("contextTranslate",{text:"Translate",onclick:function(){T=tinymce.activeEditor.selection.getBookmark(2,!0),c(e.selection.getRng()),tinymce.activeEditor.fire("change")},onPostRender:v})})}});