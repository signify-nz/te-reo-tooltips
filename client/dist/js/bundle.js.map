{"version":3,"sources":["webpack:///webpack/bootstrap ea43400a668e164f3054","webpack:///./client/src/js/TeReoPlugin.js"],"names":["tinymce","PluginManager","add","editor","url","dictionaryMap","Map","library","bookmark","addHtmlToTextNode","textNode","innerHTML","span","document","createElement","parentNode","insertBefore","insertAdjacentHTML","remove","escapeHtml","text","replace","checkForMatches","content","shortcode","openTag","closeTag","inputList","split","outputList","i","length","has","trim","push","join","treeWalk","rng","startNode","selection","getNode","walker","dom","TreeWalker","found","finished","garbage","currentNode","current","isEqualNode","startContainer","endContainer","nodeType","result","nodeValue","substr","startOffset","getContent","endOffset","next","moveToBookmark","newWordPair","base","destination","id","activeEditor","windowManager","alert","get","request","XMLHttpRequest","path","open","tokenElement","getElementById","token","getAttribute","setRequestHeader","body","JSON","stringify","baseWord","destinationWord","send","onreadystatechange","handleUpdateResponse","readyState","status","set","close","response","translateThroughAPI","textContent","handleTranslationResponse","setContent","responseText","format","undoManager","getDictionary","handleWordPairResponse","parse","Base","Destination","getDictionaries","handleDictionaryResponse","Title","value","ID","on","restoreShortcodes","restoration","match","slice","replaceShortcodes","zeroWidthSpace","size","event","addToDictMenu","layout","pack","align","onClose","focus","onSubmit","buttons","subtype","onclick","selectedID","find","o","type","flex","title","items","padding","labelGap","spacing","name","label","tooltip","values","onPostRender","handleActiveState","btn","disabled","addMenuItem","addButton","image","getBookmark","fire","getRng"],"mappings":"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","file":"js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/js/TeReoPlugin.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap ea43400a668e164f3054","/* global tinymce */\n// eslint-disable-next-line no-unused-vars\ntinymce.PluginManager.add('TeReoPlugin', (editor, url) => {\n  // Likely need to 'escape' regex function, possible security issue with user input. https://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n    const dictionaryMap = new Map();\n    const library = [];\n    let bookmark;\n\n  // credit: https://stackoverflow.com/questions/16662393/insert-html-into-text-node-with-javascript\n    function addHtmlToTextNode(textNode, innerHTML) {\n        const span = document.createElement('span');\n        textNode.parentNode.insertBefore(span, textNode);\n        span.insertAdjacentHTML('beforebegin', innerHTML);\n        span.remove();\n        return textNode;\n    }\n\n  // credit: https://stackoverflow.com/questions/6234773/can-i-escape-html-special-chars-in-javascript\n    function escapeHtml(text) {\n        return text\n        .replace(/&/g, '&amp;')\n        .replace(/</g, '&lt;')\n        .replace(/>/g, '&gt;')\n        .replace(/\"/g, '&quot;')\n        .replace(/'/g, '&#039;');\n    }\n\n    function checkForMatches(content, shortcode = true) {\n        let openTag = '';\n        let closeTag = '';\n        if (!content) {\n            return content;\n        }\n        if (shortcode) {\n            openTag = '[TT]';\n            closeTag = '[/TT]';\n        } else {\n            openTag = '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline 1px dashed;\">';\n            closeTag = '</span>';\n        }\n        const inputList = content.split(/\\b/g);\n        const outputList = [];\n        for (let i = 0; i < inputList.length; i++) {\n            if (dictionaryMap.has(inputList[i].trim())) {\n                outputList.push(openTag + inputList[i] + closeTag);\n            } else {\n                outputList.push(inputList[i]);\n            }\n        }\n        return outputList.join('');\n    }\n\n  // The value of this function over something more simple (i.e. getContent, modify, setContent)\n  // is that it circumvents tinymce's cleanup functionality which\n  // will insert HTML tags when modifying a selection\n    function treeWalk(rng) {\n        const startNode = editor.selection.getNode();\n        const walker = new tinymce.dom.TreeWalker(startNode);\n        let found = false;\n        let finished = false;\n        let garbage;\n        do {\n            if (garbage) {\n                garbage.remove();\n                garbage = null;\n            }\n            const currentNode = walker.current();\n            if (\n            currentNode.isEqualNode(rng.startContainer)\n            && currentNode.isEqualNode(rng.endContainer)\n            && currentNode.nodeType === 3\n            ) {\n                found = false;\n                const result = escapeHtml(currentNode.nodeValue.substr(0, rng.startOffset))\n                + checkForMatches(editor.selection.getContent(), false)\n                + escapeHtml(currentNode.nodeValue.substr(rng.endOffset));\n                garbage = addHtmlToTextNode(currentNode, result);\n            } else if (currentNode.nodeType === 3) {\n                if (currentNode.isEqualNode(rng.endContainer)) {\n                    const result = checkForMatches(\n                      currentNode.nodeValue.substr(0, rng.endOffset), false)\n                    + currentNode.nodeValue.substr(rng.endOffset);\n                    garbage = addHtmlToTextNode(currentNode, result);\n                    found = false;\n                    finished = true;\n                } else if (found) {\n                    const result = checkForMatches(currentNode.nodeValue, false);\n                    garbage = addHtmlToTextNode(currentNode, result);\n                } else if (currentNode.isEqualNode(rng.startContainer)) {\n                    const result = currentNode.nodeValue.substr(0, rng.startOffset)\n                    + checkForMatches(currentNode.nodeValue.substr(rng.startOffset), false);\n                    garbage = addHtmlToTextNode(currentNode, result);\n                    found = true;\n                }\n            }\n        } while (walker.next() && !finished);\n        if (garbage) {\n            garbage.remove();\n        }\n        editor.selection.moveToBookmark(bookmark);\n    }\n\n    function newWordPair(base, destination, id) {\n        if (!base || !destination) {\n            tinymce.activeEditor.windowManager.alert('Cannot submit an empty field!');\n        } else if (dictionaryMap.has(base)) {\n            tinymce.activeEditor.windowManager.alert(`This word already has a translation! (${dictionaryMap.get(base)})`);\n        } else {\n            const request = new XMLHttpRequest();\n            const path = `/api/v1/dictionary/addWordPair/${id}`;\n            request.open('POST', path);\n            const tokenElement = document.getElementById('Form_EditForm_SecurityID');\n            const token = tokenElement.getAttribute('value');\n            request.setRequestHeader('X-SecurityID', token);\n            const body = JSON.stringify({\n                baseWord: base,\n                destinationWord: destination\n            });\n            request.send(body);\n            request.onreadystatechange = function handleUpdateResponse() {\n                if (this.readyState === 4 && this.status === 200) {\n                    dictionaryMap.set(base, destination);\n                    tinymce.activeEditor.windowManager.close();\n                    tinymce.activeEditor.windowManager.alert(`Successfully added wordpair \"${base}\", \"${destination}\".`);\n                }\n                if (this.readyState === 4 && this.status === 400) {\n                    tinymce.activeEditor.windowManager.alert(this.response);\n                }\n            };\n        }\n    }\n\n  // Post request can handle much larger quantities\n  // Tested with 15000 word request with approx 1 sec delay\n    function translateThroughAPI(textContent) {\n        const request = new XMLHttpRequest();\n        const path = '/api/v1/dictionary/translateThroughInterface';\n        request.open('POST', path, true);\n        const tokenElement = document.getElementById('Form_EditForm_SecurityID');\n        const token = tokenElement.getAttribute('value');\n        request.setRequestHeader('X-SecurityID', token);\n        request.onreadystatechange = function handleTranslationResponse() {\n            if (this.readyState === 4 && this.status === 200) {\n                editor.setContent(request.responseText, { format: 'html' });\n                editor.undoManager.add();\n                tinymce.activeEditor.selection.moveToBookmark(bookmark);\n            }\n        };\n        request.send(textContent);\n    }\n\n  // pass dictionary ID as argument to receive that dictionary, pass 0 to get currently dictionary\n    function getDictionary(id) {\n        const request = new XMLHttpRequest();\n        const path = `/api/v1/dictionary/dictionaries/${id}`;\n        request.open('GET', path);\n        const tokenElement = document.getElementById('Form_EditForm_SecurityID');\n        const token = tokenElement.getAttribute('value');\n        request.setRequestHeader('X-SecurityID', token);\n        request.send();\n        request.onreadystatechange = function handleWordPairResponse() {\n            if (this.readyState === 4 && this.status === 200) {\n                let response = request.responseText;\n                response = JSON.parse(response);\n                for (let i = 0; i < response.length; i++) {\n                    dictionaryMap.set(response[i].Base, response[i].Destination);\n                }\n            }\n        };\n    }\n\n    function getDictionaries() {\n      // needs to get only this siteconfig dicts\n        const request = new XMLHttpRequest();\n        const path = '/api/v1/dictionary/index/';\n        request.open('GET', path);\n        const tokenElement = document.getElementById('Form_EditForm_SecurityID');\n        const token = tokenElement.getAttribute('value');\n        request.setRequestHeader('X-SecurityID', token);\n        request.send();\n        request.onreadystatechange = function handleDictionaryResponse() {\n            if (this.readyState === 4 && this.status === 200) {\n                let response = request.responseText;\n                if (response) {\n                  response = JSON.parse(response);\n                  for (let i = 0; i < response.length; i++) {\n                      library.push({\n                          text: response[i].Title,\n                          value: response[i].Title,\n                          id: response[i].ID\n                      });\n                  }\n                }\n            }\n        };\n    }\n\n  // TODO hard-coded dictionary ID is not acceptable -- can provide no argument\n  // and receive default? I think currently it just returns a list of dictionaries\n    editor.on('init', () => {\n        getDictionary();\n        getDictionaries();\n    });\n\n  // this slice method is not robust, maybe use a regex to find everything between\n  // the first '>' and the second '<'\n  // Address zero width space duplication by having a second content.replace?\nfunction restoreShortcodes(content) {\n    let restoration = null;\n    const startOffset = 74;\n    const endOffset = 7;\n    return content.replace(/(<span class=\"TeReoTooltip\" style=\"text-decoration: underline 1px dashed;\">)(.+?)(<\\/span>)/g, (match) => {\n        if (dictionaryMap.has(match.slice(startOffset, match.length - endOffset))) {\n            restoration = `[TT]${match.slice(startOffset, match.length - endOffset)}[/TT]`;\n        } else {\n            restoration = checkForMatches(match.slice(startOffset, match.length - endOffset));\n        }\n        return restoration;\n    });\n}\n\n  // adding a zero width space on the end means that text written after\n  // a translation will not be in the span.\n  // this has a hasty bug fix, this code runs before the dictionarymap is populated, so the\n  // shortcodes are not replaced on page load. the last 'if else' addresses this\nfunction replaceShortcodes(content) {\n    const startOffset = 4;\n    const endOffset = 5;\n    const openTag = '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline 1px dashed;\">';\n    const closeTag = '</span>';\n    const zeroWidthSpace = '&#8203';\n    // preceded by '[TT]', anything between, followed by '[/TT]'\n    return content.replace(/\\[TT([^\\]]*)\\]([^\\]]*)\\[\\/TT\\]/g, (match) => {\n        if (dictionaryMap.has(match.slice(startOffset, match.length - endOffset))) {\n            return openTag\n            + match.slice(startOffset, match.length - endOffset)\n            + closeTag\n            + zeroWidthSpace;\n        }\n        if (dictionaryMap.size === 0) {\n            return openTag\n            + match.slice(startOffset, match.length - endOffset)\n            + closeTag\n            + zeroWidthSpace;\n        }\n        return match.slice(startOffset, match.length - endOffset);\n    });\n}\n\n  // Before content is set in the editor, the shortcodes are\n  // replaced with a simple span tag to style and delineate translations\n  editor.on('BeforeSetcontent', (event) => {\n    // eslint-disable-next-line no-param-reassign\n        event.content = replaceShortcodes(event.content);\n    });\n\n  // When content is retrieved from the editor, the span tag\n  // is removed and the shortcodes are restored\n  editor.on('GetContent', (event) => {\n    // eslint-disable-next-line no-param-reassign\n        event.content = restoreShortcodes(event.content);\n    });\n\n  // Credit to the searchReplace plugin for how to do this\nfunction addToDictMenu(selection) {\n    editor.windowManager.open({\n        layout: 'flex',\n        pack: 'center',\n        align: 'center',\n        onClose() {\n            editor.focus();\n        },\n        onSubmit() {\n        },\n        buttons: [\n        {\n            text: 'Add',\n            subtype: 'primary',\n            onclick() {\n              // This is likely messier than it needs to be. can it\n              // handle special characters? is there any conversion?\n                const selectedID = library.find(o => o.text === document.getElementById('DictionaryDisplayComboBox-inp').value).id;\n                newWordPair(document.getElementById('BaseInputTextBox').value.trim(), document.getElementById('DestinationInputTextBox').value.trim(), selectedID);\n            }\n        },\n        { type: 'spacer', flex: 1 },\n        ],\n        title: 'Add to Dictionary',\n        items: {\n            type: 'form',\n            padding: 20,\n            labelGap: 30,\n            spacing: 10,\n            items: [\n            { type: 'textbox', name: 'Base', size: 40, label: 'Base', value: selection.trim(), id: 'BaseInputTextBox', tooltip: 'An untranslated word' },\n            { type: 'textbox', name: 'Destination', size: 40, label: 'Translation', id: 'DestinationInputTextBox', tooltip: 'A translated word' },\n            {\n                type: 'combobox',\n                name: 'Dictionary',\n                size: 40,\n                label: 'Dictionary',\n                id: 'DictionaryDisplayComboBox',\n                tooltip: 'Select which dictionary you want to add to',\n                values: library,\n                onPostRender() {\n                  // Select the first item by default, should get active?\n                    this.value(library[0].value);\n                },\n            },\n            ],\n        },\n    });\n}\n\nfunction handleActiveState() {\n    const btn = this;\n    // there must be a better event to bind this to\n    editor.on('MouseMove', () => {\n        btn.disabled(library.length === 0);\n    });\n}\n\n  editor.addMenuItem('addToDictionary', {\n        text: 'Add to Dictionary',\n        onclick() {\n            const selection = editor.selection.getContent({ format: 'text' });\n            addToDictMenu(selection);\n        },\n        onPostRender: handleActiveState\n    });\n\n  editor.addButton('translate', {\n        image: '/_resources/vendor/signify-nz/te_reo_tooltips/client/dist/img/globe-light.svg',\n        tooltip: 'Translate content',\n        onclick() {\n            bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\n            editor.undoManager.add();\n            translateThroughAPI(editor.getContent());\n            tinymce.activeEditor.fire('change');\n        },\n        onPostRender: handleActiveState\n    });\n\n  // repeated translations cause issues, fix by adding validation in checkForMatches?\n  editor.addMenuItem('contextTranslate', {\n        text: 'Translate',\n        onclick() {\n            bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\n            treeWalk(editor.selection.getRng());\n            tinymce.activeEditor.fire('change');\n        },\n        onPostRender: handleActiveState\n    });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/js/TeReoPlugin.js"],"sourceRoot":""}