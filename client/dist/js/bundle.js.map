{"version":3,"sources":["webpack:///webpack/bootstrap 23e3df61c2cbb82cd580","webpack:///./te_reo_plugin/TeReoPlugin.js"],"names":["tinymce","PluginManager","add","editor","url","dictionaryMap","Map","library","bookmark","addButton","image","tooltip","onclick","activeEditor","selection","getBookmark","undoManager","translateThroughAPI","getContent","fire","addMenuItem","text","console","log","format","treeWalk","getRng","getSel","addEventHandler","elements","document","getElementsByClassName","myFunction","event","target","style","color","i","length","addEventListener","rng","sel","startNode","getNode","walker","dom","TreeWalker","found","finished","garbage","remove","currentNode","current","isEqualNode","startContainer","endContainer","nodeType","result","escapeHtml","nodeValue","substr","startOffset","checkForMatches","endOffset","addHtmlToTextNode","next","moveToBookmark","textNode","innerHTML","span","createElement","parentNode","insertBefore","insertAdjacentHTML","replace","addToDictMenu","newWordPair","base","destination","id","windowManager","alert","has","get","tinyMCE","close","Http","XMLHttpRequest","open","send","onreadystatechange","readyState","status","set","layout","pack","align","onClose","focus","onSubmit","buttons","subtype","selectedID","find","o","getElementById","value","type","flex","title","items","padding","labelGap","spacing","name","size","label","trim","values","onPostRender","textContent","DONE","setContent","responseText","getDictionary","ID","response","JSON","parse","getDictionaries","push","content","shortcode","openTag","closeTag","inputList","split","outputList","join","on","replaceShortcodes","restoreShortcodes","restoration","match","slice"],"mappings":"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","file":"js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./te_reo_plugin/TeReoPlugin.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 23e3df61c2cbb82cd580","tinymce.PluginManager.add('TeReoPlugin', function (editor, url) {\r\n\r\n    // Likely need to 'escape' regex function, possible security issue with user input. https://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\r\n    var dictionaryMap = new Map();\r\n    var library = [];\r\n    var bookmark;\r\n\r\n    editor.addButton('translate', {\r\n        image: 'public/_resources/vendor/signify-nz/te_reo_tooltips/client/dist/img/globe-light.svg',\r\n        tooltip: \"Translate content\",\r\n        onclick: function () {\r\n            bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\r\n            editor.undoManager.add();\r\n            translateThroughAPI(editor.getContent());\r\n            tinymce.activeEditor.fire('change');\r\n        }\r\n    });\r\n\r\n    //repeated translations cause issues, fix by adding validation in checkForMatches?\r\n    editor.addMenuItem('contextTranslate', {\r\n        text: 'Translate',\r\n        onclick: function () {\r\n            console.log(\"Selection content = \" + editor.selection.getContent({ format: 'html' }));\r\n            bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\r\n            //Passing the selection argument here seems unneccesary\r\n            treeWalk(editor.selection.getRng(), editor.selection.getSel());\r\n\r\n            // Could make this selectively fire only if changes are made? Entwine with undo functionality i think\r\n            tinymce.activeEditor.fire('change');\r\n\r\n            // execCommand 'insertHTML' as an alternative method? If dom traversal is messy\r\n\r\n            //This is the previous method that used the API, issues around tinymce get/set caused this to be dropped in favour of treeWalk()\r\n            // var translation = translateSelectionThroughAPI(editor.selection.getContent({format: 'html'}));\r\n            // editor.selection.setContent(translation);\r\n\r\n            addEventHandler();\r\n        }\r\n    });\r\n\r\n    function addEventHandler() {\r\n        var elements = document.getElementsByClassName(\"TeReoTooltip\");\r\n\r\n        var myFunction = function (event) {\r\n            console.log('mouse over');\r\n            event.target.style.color = \"purple\";\r\n        };\r\n\r\n        for (var i = 0; i < elements.length; i++) {\r\n            elements[i].addEventListener('mouseover', myFunction, false);\r\n        }\r\n    };\r\n\r\n    // The value of this function over something more simple (i.e. getContent, modify, setContent) is that it circumvents tinymce's cleanup functionality \r\n    // which will insert HTML tags when modifying a selection\r\n    function treeWalk(rng, sel) {\r\n        var startNode = editor.selection.getNode();\r\n        var walker = new tinymce.dom.TreeWalker(startNode);\r\n        var found = false;\r\n        var finished = false;\r\n        var garbage;\r\n        console.log(\"treewalk begins here\");\r\n        do {\r\n            if (garbage) {\r\n                garbage.remove();\r\n                garbage = null;\r\n            }\r\n            var currentNode = walker.current();\r\n            if (currentNode.isEqualNode(rng.startContainer) && currentNode.isEqualNode(rng.endContainer) && currentNode.nodeType == 3) {\r\n                found = false;\r\n                var result = escapeHtml(currentNode.nodeValue.substr(0, rng.startOffset)) + checkForMatches(editor.selection.getContent(), false) + escapeHtml(currentNode.nodeValue.substr(rng.endOffset));\r\n                garbage = addHtmlToTextNode(currentNode, result);\r\n            } else if (currentNode.nodeType == 3) {\r\n                if (currentNode.isEqualNode(rng.endContainer)) {\r\n                    var result = checkForMatches(currentNode.nodeValue.substr(0, rng.endOffset), false) + currentNode.nodeValue.substr(rng.endOffset);\r\n                    garbage = addHtmlToTextNode(currentNode, result);\r\n                    found = false;\r\n                    finished = true;\r\n                } else if (found) {\r\n                    var result = checkForMatches(currentNode.nodeValue, false);\r\n                    garbage = addHtmlToTextNode(currentNode, result);\r\n                } else if (currentNode.isEqualNode(rng.startContainer)) {\r\n                    var result = currentNode.nodeValue.substr(0, rng.startOffset) + checkForMatches(currentNode.nodeValue.substr(rng.startOffset), false);\r\n                    garbage = addHtmlToTextNode(currentNode, result);\r\n                    found = true;\r\n                }\r\n            }\r\n        } while (walker.next() && !finished);\r\n        if (garbage) {\r\n            garbage.remove();\r\n        }\r\n        editor.selection.moveToBookmark(bookmark);\r\n    };\r\n\r\n    //credit: https://stackoverflow.com/questions/16662393/insert-html-into-text-node-with-javascript\r\n    function addHtmlToTextNode(textNode, innerHTML) {\r\n        var span = document.createElement('span');\r\n        textNode.parentNode.insertBefore(span, textNode);\r\n        span.insertAdjacentHTML('beforebegin', innerHTML);\r\n        span.remove();\r\n        return textNode;\r\n    };\r\n\r\n    //credit: https://stackoverflow.com/questions/6234773/can-i-escape-html-special-chars-in-javascript\r\n    function escapeHtml(text) {\r\n        return text\r\n            .replace(/&/g, \"&amp;\")\r\n            .replace(/</g, \"&lt;\")\r\n            .replace(/>/g, \"&gt;\")\r\n            .replace(/\"/g, \"&quot;\")\r\n            .replace(/'/g, \"&#039;\");\r\n    };\r\n\r\n    editor.addMenuItem('addToDictionary', {\r\n        text: 'Add to Dictionary',\r\n        onclick: function () {\r\n            var selection = editor.selection.getContent({ format: 'text' });\r\n            addToDictMenu(selection);\r\n        }\r\n    });\r\n\r\n    function newWordPair(base, destination, id) {\r\n        if (base == false || destination == false) {\r\n            tinymce.activeEditor.windowManager.alert(\"Cannot submit an empty field!\");\r\n        } else if (dictionaryMap.has(base)) {\r\n            tinymce.activeEditor.windowManager.alert(\"This word already has a translation! (\" + dictionaryMap.get(base) + \")\");\r\n        } else {\r\n            tinyMCE.activeEditor.windowManager.close();\r\n            const Http = new XMLHttpRequest();\r\n            const url = '/api/v1/dictionary/addWordPair/' + id + \"?base=\" + base + \"&destination=\" + destination;\r\n            Http.open(\"POST\", url);\r\n            Http.send();\r\n            Http.onreadystatechange = function () {\r\n                if (this.readyState == 4 && this.status == 200) {\r\n                    dictionaryMap.set(base, destination);\r\n                }\r\n            }\r\n\r\n        }\r\n    };\r\n\r\n    //Credit to the searchReplace plugin for how to do this\r\n    function addToDictMenu(selection) {\r\n        editor.windowManager.open({\r\n            layout: \"flex\",\r\n            pack: \"center\",\r\n            align: \"center\",\r\n            onClose: function () {\r\n                editor.focus();\r\n                // self.done();\r\n            },\r\n            onSubmit: function () {\r\n            },\r\n            buttons: [\r\n                {\r\n                    text: \"Add\", subtype: 'primary', onclick: function () {\r\n                        //This is likely messier than it needs to be. can it handle special characters? is there any conversion?\r\n                        var selectedID = library.find(o => o.text == document.getElementById('DictionaryDisplayComboBox-inp').value).id;\r\n                        newWordPair(document.getElementById('BaseInputTextBox').value, document.getElementById('DestinationInputTextBox').value, selectedID);\r\n                    }\r\n                },\r\n                { type: \"spacer\", flex: 1 },\r\n            ],\r\n            title: \"Add to Dictionary\",\r\n            items: {\r\n                type: \"form\",\r\n                padding: 20,\r\n                labelGap: 30,\r\n                spacing: 10,\r\n                items: [\r\n                    { type: 'textbox', name: 'Base', size: 40, label: 'Base', value: selection.trim(), id: 'BaseInputTextBox', tooltip: 'An untranslated word' },\r\n                    { type: 'textbox', name: 'Destination', size: 40, label: 'Translation', id: 'DestinationInputTextBox', tooltip: 'A translated word' },\r\n                    {\r\n                        type: 'combobox', name: 'Dictionary', size: 40, label: 'Dictionary', id: 'DictionaryDisplayComboBox', tooltip: 'Select which dictionary you want to add to', values: library,\r\n                        onPostRender: function () {\r\n                            // Select the first item by default, should get active?\r\n                            this.value(library[0].value);\r\n                        },\r\n                    },\r\n                ],\r\n            },\r\n        });\r\n    };\r\n\r\n    //Post request can handle much larger quantities\r\n    //Tested with 15000 word request with approx 1 sec delay\r\n    function translateThroughAPI(textContent) {\r\n        const Http = new XMLHttpRequest();\r\n        const url = '/api/v1/dictionary/translateThroughInterface';\r\n        Http.open(\"POST\", url, true);\r\n        Http.onreadystatechange = function () {\r\n            if (this.readyState === XMLHttpRequest.DONE && this.status === 200) {\r\n                editor.setContent(Http.responseText, { format: 'html' });\r\n                editor.undoManager.add();\r\n                tinymce.activeEditor.selection.moveToBookmark(bookmark);\r\n            }\r\n        }\r\n        Http.send(textContent);\r\n    };\r\n\r\n    // pass dictionary ID as argument to recieve that dictionary, pass 0 to get currently selected dictionary\r\n    // These two functions could be consolidated into one\r\n    function getDictionary(ID) {\r\n        const Http = new XMLHttpRequest();\r\n        const url = '/api/v1/dictionary/dictionaries/' + ID;\r\n        Http.open(\"GET\", url);\r\n        Http.send();\r\n        Http.onreadystatechange = function () {\r\n            if (this.readyState == 4 && this.status == 200) {\r\n                var response = Http.responseText;\r\n                response = JSON.parse(response);\r\n                console.log(\"Building local dictionary:\");\r\n                for (let i = 0; i < response.length; i++) {\r\n                    dictionaryMap.set(response[i]['Base'], response[i]['Destination']);\r\n                    console.log(\"key = \" + response[i]['Base'] + \", value = \" + response[i]['Destination']);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    function getDictionaries() {\r\n        const Http = new XMLHttpRequest();\r\n        const url = '/api/v1/index/';\r\n        Http.open(\"GET\", url);\r\n        Http.send();\r\n        Http.onreadystatechange = function () {\r\n            if (this.readyState == 4 && this.status == 200) {\r\n                var response = Http.responseText;\r\n                response = JSON.parse(response);\r\n                console.log(\"Building library:\");\r\n                for (let i = 0; i < response.length; i++) {\r\n                    library.push({ text: response[i]['Title'], value: response[i]['Title'], id: response[i]['ID'] });\r\n                    console.log(\"added dictionary = \" + response[i]['Title']);\r\n                }\r\n            }\r\n        }\r\n    };\r\n\r\n    function checkForMatches(content, shortcode = true) {\r\n        var openTag = '';\r\n        var closeTag = '';\r\n        if (!content) {\r\n            return content;\r\n        }\r\n        if (shortcode) {\r\n            openTag = '[TT]';\r\n            closeTag = '[/TT]';\r\n        } else {\r\n            openTag = '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline;\">';\r\n            closeTag = '</span>';\r\n        }\r\n        let inputList = content.split(/\\b/g)\r\n        let outputList = [];\r\n        for (let i = 0; i < inputList.length; i++) {\r\n            if (dictionaryMap.has(inputList[i].trim())) {\r\n                outputList.push(openTag + inputList[i] + closeTag);\r\n            }\r\n            else {\r\n                outputList.push(inputList[i]);\r\n            }\r\n        }\r\n        return outputList.join('');\r\n    };\r\n\r\n    // TODO hard-coded dictionary ID is not acceptable -- can provided no argument and receive default? I think currently it just returns a list of dictionaries\r\n    editor.on('init', function (event) {\r\n        getDictionary();\r\n        getDictionaries();\r\n    });\r\n\r\n    // Before content is set in the editor, the shortcodes are replaced with a simple span tag to style and delineate translations\r\n    editor.on('BeforeSetcontent', function (event) {\r\n        console.log('BeforeSetcontent');\r\n        event.content = replaceShortcodes(event.content);\r\n    });\r\n\r\n    //When content is retrieved from the editor, the span tag is removed and the shortcodes are restored\r\n    editor.on('GetContent', function (event) {\r\n        console.log('GetContent');\r\n        event.content = restoreShortcodes(event.content);\r\n    });\r\n\r\n    //this slice method is not robust, maybe use a regex to find everything between the first '>' and the second '<'\r\n    // two returns?\r\n    function restoreShortcodes(content) {\r\n        let restoration = null;\r\n        return content.replace(/(<span class=\"TeReoTooltip\" style=\"text-decoration: underline;\">)(.+?)(<\\/span>)/g, function (match) {\r\n            if (dictionaryMap.has(match.slice(63, match.length - 7))) {\r\n                restoration = '[TT]' + match.slice(63, match.length - 7) + '[/TT]';\r\n            } else {\r\n                console.log(\"Does not match a dictionary, looking deeper\");\r\n                restoration = checkForMatches(match.slice(63, match.length - 7));\r\n            }\r\n            return restoration;\r\n        });\r\n    }\r\n\r\n    // adding a zero width space on the end means that text written after a translation will not be in the span\r\n    // this has a hasty bug fix, this code runs before the dictionarymap is populated, so the shortcodes are not replaced on page load. the last 'if else' addresses this\r\n    function replaceShortcodes(content) {\r\n        console.log('replaceShortcodes');\r\n        // preceded by '[TT]', anything between, followed by [/TT]\r\n        return content.replace(/\\[TT([^\\]]*)\\]([^\\]]*)\\[\\/TT\\]/g, function (match) {\r\n            if (dictionaryMap.has(match.slice(4, match.length - 5))) {\r\n                console.log(\"found = '\" + match + \"', replaced with span \" + match.slice(4, match.length - 5) + \" span\");\r\n                return '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline;\">' + match.slice(4, match.length - 5) + '</span>&#8203';\r\n            } else {\r\n                if (dictionaryMap.size == 0) {\r\n                    console.log(\"empty dictionary, you should only see this on init\");\r\n                    return '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline;\">' + match.slice(4, match.length - 5) + '</span>&#8203'\r\n                } else {\r\n                    return match.slice(4, match.length - 5);\r\n                }\r\n            }\r\n        });\r\n    }\r\n});\n\n\n// WEBPACK FOOTER //\n// ./te_reo_plugin/TeReoPlugin.js"],"sourceRoot":""}