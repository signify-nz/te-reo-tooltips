{"version":3,"sources":["webpack:///webpack/bootstrap 3f31a6e6fe5f065cb930","webpack:///./client/src/js/TeReoPlugin.js"],"names":["tinymce","PluginManager","add","editor","url","dictionaryMap","Map","library","bookmark","addHtmlToTextNode","textNode","innerHTML","span","document","createElement","parentNode","insertBefore","insertAdjacentHTML","remove","escapeHtml","text","replace","regexQuote","str","encode","encodedString","i","length","codePointAt","decode","splitString","split","filter","Boolean","decodedStr","String","fromCodePoint","console","log","join","checkForMatches","content","shortcode","openTag","closeTag","openRegex","closeRegex","alteredContent","forEach","value","key","quotedKey","regex","RegExp","regexDecode","match","treeWalk","rng","startNode","selection","getNode","nodeType","firstChild","nodeValue","walker","dom","TreeWalker","foundStartNode","finished","garbage","currentNode","current","isEqualNode","startContainer","endContainer","getStart","result","substr","startOffset","getContent","endOffset","next","moveToBookmark","newWordPair","base","destination","id","activeEditor","windowManager","alert","has","get","request","XMLHttpRequest","path","open","tokenElement","getElementsByName","token","getAttribute","setRequestHeader","body","JSON","stringify","dictionaryID","baseWord","destinationWord","send","onreadystatechange","handleUpdateResponse","readyState","status","set","close","response","translateThroughAPI","textContent","handleTranslationResponse","setContent","responseText","format","undoManager","getDictionary","handleWordPairResponse","parse","Base","Destination","getDictionaries","handleDictionaryResponse","push","Title","ID","on","restoreShortcodes","restoration","slice","toLowerCase","replaceShortcodes","zeroWidthSpace","spaceInserted","includes","size","event","addToDictMenu","layout","pack","align","onClose","focus","onSubmit","buttons","subtype","onclick","selectedID","find","o","getElementById","type","flex","title","items","padding","labelGap","spacing","name","label","trim","tooltip","values","onPostRender","handleActiveState","btn","disabled","addMenuItem","addButton","image","getBookmark","fire","getRng"],"mappings":"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","file":"js/bundle.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// identity function for calling harmony imports with the correct context\n \t__webpack_require__.i = function(value) { return value; };\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, {\n \t\t\t\tconfigurable: false,\n \t\t\t\tenumerable: true,\n \t\t\t\tget: getter\n \t\t\t});\n \t\t}\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = \"./client/src/js/TeReoPlugin.js\");\n\n\n\n// WEBPACK FOOTER //\n// webpack/bootstrap 3f31a6e6fe5f065cb930","/* global tinymce */\n// eslint-disable-next-line no-unused-vars\ntinymce.PluginManager.add('TeReoPlugin', (editor, url) => {\n  // Likely need to 'escape' regex function, possible security issue with user input. https://stackoverflow.com/questions/3561493/is-there-a-regexp-escape-function-in-javascript\n  const dictionaryMap = new Map();\n  const library = [];\n  let bookmark;\n\n  // credit: https://stackoverflow.com/questions/16662393/insert-html-into-text-node-with-javascript\n  function addHtmlToTextNode(textNode, innerHTML) {\n    const span = document.createElement('span');\n    textNode.parentNode.insertBefore(span, textNode);\n    span.insertAdjacentHTML('beforebegin', innerHTML);\n    span.remove();\n    return textNode;\n  }\n\n  // credit: https://stackoverflow.com/questions/6234773/can-i-escape-html-special-chars-in-javascript\n  function escapeHtml(text) {\n    return text\n    .replace(/&/g, '&amp;')\n    .replace(/</g, '&lt;')\n    .replace(/>/g, '&gt;')\n    .replace(/\"/g, '&quot;')\n    .replace(/'/g, '&#039;');\n  }\n\n  function regexQuote(str) {\n    if (!str) {\n      return '';\n    }\n    return (str).replace(/[.?*+^$[\\]\\\\(){}|-]/g, '\\\\$&');\n  }\n\n  function encode(str) {\n    // console.log(`encodeMatch: ${str}`);\n    let encodedString = '-%-%-';\n    for (let i = 0; i < str.length; i++) {\n      encodedString += `${str.codePointAt(i)}-`;\n    }\n    encodedString += '%-%-';\n    // console.log(`encodedMatch: ${encodedString}`);\n    return encodedString;\n  }\n\n  function decode(str) {\n    let splitString = str.split('-%-%-').filter(Boolean);\n    splitString = splitString[0].split('-');\n    const decodedStr = [];\n    for (let i = 0; i < splitString.length; i++) {\n    decodedStr[i] = String.fromCodePoint(splitString[i]);\n    }\n    console.log(`decodedMatch: ${decodedStr}`);\n    return decodedStr.join('');\n  }\n\n  function checkForMatches(content, shortcode = true) {\n    // This may no longer work with different open and close tags,\n    // the addition of regex changed things substantially\n    console.log(`The following content is being checked for matches: ${content}`);\n    let openTag = '';\n    let closeTag = '';\n    let openRegex = '';\n    let closeRegex = '';\n    if (!content) {\n      return content;\n    }\n    if (shortcode) {\n      openTag = '[TT]';\n      closeTag = '[/TT]';\n      // TO-DO add regex for this instance? not currently used anywhere\n    } else {\n      openTag = '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline 1px dashed;\">';\n      closeTag = '</span>';\n      openRegex = '(?<![a-zA-Z0-9])(';\n      closeRegex = ')(?!\\[\\/TT])(?![a-zA-Z0-9])(?![^<]*\\>)';\n    }\n    let alteredContent = content;\n\n    // leading and trailing slashes inserted during instantiation of regexp object\n    dictionaryMap.forEach((value, key) => {\n      const quotedKey = regexQuote(key);\n      const regex = new RegExp(openRegex + quotedKey + closeRegex, 'gi');\n      alteredContent = alteredContent.replace(regex, openTag + encode(key) + closeTag);\n    });\n    const regexDecode = new RegExp('(-%-%-).*?(-%-%-)', 'gi');\n    // console.log(`altered content before decoding ${alteredContent}`);\n    alteredContent = alteredContent.replace(regexDecode, (match) => {\n      console.log(`decodeMatch: ${match}`);\n      return decode(match);\n    }\n    );\n    // console.log(`altered content after decoding ${alteredContent}`);\n    return alteredContent;\n  }\n\n  // The value of this function over something more simple (i.e. getContent, modify, setContent)\n  // is that it circumvents tinymce's cleanup functionality which\n  // will insert HTML tags when modifying a selection\n  function treeWalk(rng) {\n    let startNode = editor.selection.getNode();\n    if (startNode.nodeType === 1) {\n      startNode = startNode.firstChild;\n    };\n    console.log(startNode.nodeValue);\n    console.log(startNode.nodeType);\n    const walker = new tinymce.dom.TreeWalker(startNode);\n    let foundStartNode = false;\n    let finished = false;\n    let garbage;\n    do {\n      if (garbage) {\n        garbage.remove();\n        garbage = null;\n      }\n      const currentNode = walker.current();\n      console.log(`Current node value is: ${currentNode.nodeValue}`);\n      console.log(`Current node type is: ${currentNode.nodeType}`);\n      if (\n        currentNode.isEqualNode(rng.startContainer)\n        && currentNode.isEqualNode(rng.endContainer)\n        && currentNode.nodeType === 3\n      ) {\n        console.log('here');\n        console.log(`content: ${editor.selection.getStart()}`);\n        console.log(`content: ${editor.selection.getStart()}`);\n        foundStartNode = false;\n        const result = escapeHtml(currentNode.nodeValue.substr(0, rng.startOffset))\n        + checkForMatches(editor.selection.getContent(), false)\n        + escapeHtml(currentNode.nodeValue.substr(rng.endOffset));\n        garbage = addHtmlToTextNode(currentNode, result);\n      } else if (currentNode.nodeType === 3) {\n        if (currentNode.isEqualNode(rng.endContainer)\n        && foundStartNode) {\n          const result = checkForMatches(\n          currentNode.nodeValue.substr(0, rng.endOffset), false)\n          + currentNode.nodeValue.substr(rng.endOffset);\n          garbage = addHtmlToTextNode(currentNode, result);\n          foundStartNode = false;\n          finished = true;\n        } else if (foundStartNode) {\n          const result = checkForMatches(currentNode.nodeValue, false);\n          garbage = addHtmlToTextNode(currentNode, result);\n        } else if (currentNode.isEqualNode(rng.startContainer)) {\n          const result = currentNode.nodeValue.substr(0, rng.startOffset)\n          + checkForMatches(currentNode.nodeValue.substr(rng.startOffset), false);\n          garbage = addHtmlToTextNode(currentNode, result);\n          foundStartNode = true;\n        }\n      }\n    } while (walker.next() && !finished);\n    if (garbage) {\n      garbage.remove();\n    }\n    editor.selection.moveToBookmark(bookmark);\n  }\n\n  function newWordPair(base, destination, id) {\n    if (!base || !destination) {\n      tinymce.activeEditor.windowManager.alert('Cannot submit an empty field!');\n    } else if (dictionaryMap.has(base)) {\n      tinymce.activeEditor.windowManager.alert(`This word already has a translation! (${dictionaryMap.get(base)})`);\n    } else {\n      const request = new XMLHttpRequest();\n      const path = '/api/v1/dictionary/addWordPair/';\n      request.open('POST', path);\n      const tokenElement = document.getElementsByName('SecurityID')[0];\n      const token = tokenElement.getAttribute('value');\n      request.setRequestHeader('X-SecurityID', token);\n      const body = JSON.stringify({\n        dictionaryID: id,\n        baseWord: base,\n        destinationWord: destination\n      });\n      request.send(body);\n      request.onreadystatechange = function handleUpdateResponse() {\n        if (this.readyState === 4 && this.status === 200) {\n          dictionaryMap.set(base, destination);\n          tinymce.activeEditor.windowManager.close();\n          tinymce.activeEditor.windowManager.alert(`Successfully added wordpair \"${base}\", \"${destination}\".`);\n        }\n        if (this.readyState === 4 && this.status === 400) {\n          tinymce.activeEditor.windowManager.alert(this.response);\n        }\n      };\n    }\n  }\n\n  // Post request can handle much larger quantities\n  // Tested with 15000 word request with approx 1 sec delay\n  function translateThroughAPI(textContent) {\n    const request = new XMLHttpRequest();\n    const path = '/api/v1/dictionary/translateThroughInterface';\n    request.open('POST', path, true);\n    const tokenElement = document.getElementsByName('SecurityID')[0];\n    const token = tokenElement.getAttribute('value');\n    request.setRequestHeader('X-SecurityID', token);\n    request.onreadystatechange = function handleTranslationResponse() {\n      if (this.readyState === 4 && this.status === 200) {\n        editor.setContent(request.responseText, { format: 'html' });\n        editor.undoManager.add();\n        tinymce.activeEditor.selection.moveToBookmark(bookmark);\n      }\n    };\n    request.send(textContent);\n  }\n\n  // pass dictionary ID as argument to receive that dictionary, pass 0 to get currently dictionary\n  function getDictionary(id) {\n    const request = new XMLHttpRequest();\n    const path = `/api/v1/dictionary/dictionaries/${id}`;\n    request.open('GET', path);\n    const tokenElement = document.getElementsByName('SecurityID')[0];\n    const token = tokenElement.getAttribute('value');\n    request.setRequestHeader('X-SecurityID', token);\n    request.send();\n    request.onreadystatechange = function handleWordPairResponse() {\n      if (this.readyState === 4 && this.status === 200) {\n        let response = request.responseText;\n        response = JSON.parse(response);\n        for (let i = 0; i < response.length; i++) {\n          dictionaryMap.set(response[i].Base, response[i].Destination);\n        }\n      }\n    };\n  }\n\n  function getDictionaries() {\n    // needs to get only this siteconfig dicts\n    const request = new XMLHttpRequest();\n    const path = '/api/v1/dictionary/index/';\n    request.open('GET', path);\n    const tokenElement = document.getElementsByName('SecurityID')[0];\n    const token = tokenElement.getAttribute('value');\n    request.setRequestHeader('X-SecurityID', token);\n    request.send();\n    request.onreadystatechange = function handleDictionaryResponse() {\n      if (this.readyState === 4 && this.status === 200) {\n        let response = request.responseText;\n        if (response) {\n          response = JSON.parse(response);\n          for (let i = 0; i < response.length; i++) {\n            library.push({\n              text: response[i].Title,\n              value: response[i].Title,\n              id: response[i].ID\n            });\n          }\n        }\n      }\n    };\n  }\n\n  // TODO hard-coded dictionary ID is not acceptable -- can provide no argument\n  // and receive default? I think currently it just returns a list of dictionaries\n  editor.on('init', () => {\n    getDictionary();\n    getDictionaries();\n  });\n\n  // this slice method is not robust, maybe use a regex to find everything between\n  // the first '>' and the second '<'\n  // Address zero width space duplication by having a second content.replace?\n  function restoreShortcodes(content) {\n    let restoration = null;\n    const startOffset = 74;\n    const endOffset = 7;\n    return content.replace(/(<span class=\"TeReoTooltip\" style=\"text-decoration: underline 1px dashed;\">)(.+?)(<\\/span>)/g, (match) => {\n      restoration = match.slice(startOffset, match.length - endOffset);\n      dictionaryMap.forEach((value, key) => {\n        if (key.toLowerCase() ===\n        match.slice(startOffset, match.length - endOffset).toLowerCase()) {\n          restoration = `[TT]${match.slice(startOffset, match.length - endOffset)}[/TT]`;\n        }\n      });\n      if (!restoration) {\n        restoration = match.slice(startOffset, match.length - endOffset);\n      }\n      return restoration;\n    });\n  }\n\n  // adding a zero width space on the end means that text written after\n  // a translation will not be in the span.\n  // this has a hasty bug fix, this code runs before the dictionarymap is populated, so the\n  // shortcodes are not replaced on page load. the last 'if else' addresses this\n  function replaceShortcodes(content) {\n    const startOffset = 4;\n    const endOffset = 5;\n    const openTag = '<span class=\\\"TeReoTooltip\\\" style=\"text-decoration: underline 1px dashed;\">';\n    const closeTag = '</span>';\n    const zeroWidthSpace = '&#8203';\n    let restoration = '';\n    // preceded by '[TT]', anything between, followed by '[/TT]'\n    return content.replace(/\\[TT([^\\]]*)\\]([^\\]]*)\\[\\/TT\\]/g, (match) => {\n      const spaceInserted = match.includes(zeroWidthSpace);\n      if (dictionaryMap.size === 0) {\n        restoration = openTag\n        + match.slice(startOffset, match.length - endOffset)\n        + closeTag;\n        if (!spaceInserted) {\n          restoration += zeroWidthSpace;\n        }\n        return restoration;\n      }\n      dictionaryMap.forEach((value, key) => {\n        if (key.toLowerCase() ===\n        match.slice(startOffset, match.length - endOffset).toLowerCase()) {\n          restoration = openTag\n          + match.slice(startOffset, match.length - endOffset)\n          + closeTag;\n          if (!spaceInserted) {\n          restoration += zeroWidthSpace;\n          }\n        }\n      });\n      if (!restoration) {\n        restoration = match.slice(startOffset, match.length - endOffset);\n      }\n      return restoration;\n    });\n  }\n\n  // Before content is set in the editor, the shortcodes are\n  // replaced with a simple span tag to style and delineate translations\n  editor.on('BeforeSetcontent', (event) => {\n    // eslint-disable-next-line no-param-reassign\n    event.content = replaceShortcodes(event.content);\n  });\n\n  // When content is retrieved from the editor, the span tag\n  // is removed and the shortcodes are restored\n  editor.on('GetContent', (event) => {\n    // eslint-disable-next-line no-param-reassign\n    event.content = restoreShortcodes(event.content);\n  });\n\n  // Credit to the searchReplace plugin for how to do this\n  function addToDictMenu(selection) {\n    editor.windowManager.open({\n      layout: 'flex',\n      pack: 'center',\n      align: 'center',\n      onClose() {\n        editor.focus();\n      },\n      onSubmit() {\n      },\n      buttons: [\n        {\n          text: 'Add',\n          subtype: 'primary',\n          onclick() {\n            // This is likely messier than it needs to be. can it\n            // handle special characters? is there any conversion?\n            const selectedID = library.find(o => o.text === document.getElementById('DictionaryDisplayComboBox-inp').value).id;\n            newWordPair(document.getElementById('BaseInputTextBox').value.replace(/[\\u200B-\\u200D\\uFEFF]/g, ''), document.getElementById('DestinationInputTextBox').value, selectedID);\n            }\n        },\n        { type: 'spacer', flex: 1 },\n      ],\n      title: 'Add to Dictionary',\n      items: {\n        type: 'form',\n        padding: 20,\n        labelGap: 30,\n        spacing: 10,\n        items: [\n          { type: 'textbox', name: 'Base', size: 40, label: 'Base', value: selection.trim(), id: 'BaseInputTextBox', tooltip: 'An untranslated word' },\n          { type: 'textbox', name: 'Destination', size: 40, label: 'Translation', id: 'DestinationInputTextBox', tooltip: 'A translated word' },\n          {\n            type: 'combobox',\n            name: 'Dictionary',\n            size: 40,\n            label: 'Dictionary',\n            id: 'DictionaryDisplayComboBox',\n            tooltip: 'Select which dictionary you want to add to',\n            values: library,\n            onPostRender() {\n              // Select the first item by default, should get active?\n              this.value(library[0].value);\n            },\n          },\n        ],\n      },\n    });\n  }\n\n  function handleActiveState() {\n    const btn = this;\n    // there must be a better event to bind this to\n    editor.on('MouseMove', () => {\n      btn.disabled(library.length === 0);\n    });\n  }\n\n  editor.addMenuItem('addToDictionary', {\n    text: 'Add to Dictionary',\n    onclick() {\n      const selection = editor.selection.getContent({ format: 'text' });\n      addToDictMenu(selection);\n    },\n    onPostRender: handleActiveState\n  });\n\n  editor.addButton('translate', {\n    image: '/_resources/vendor/signify-nz/te-reo-tooltips/client/dist/img/globe-light.svg',\n    tooltip: 'Translate content',\n    onclick() {\n      bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\n      editor.undoManager.add();\n      translateThroughAPI(editor.getContent());\n      tinymce.activeEditor.fire('change');\n    },\n    onPostRender: handleActiveState\n  });\n\n  // repeated translations cause issues, fix by adding validation in checkForMatches?\n  editor.addMenuItem('contextTranslate', {\n    text: 'Translate',\n    onclick() {\n      bookmark = tinymce.activeEditor.selection.getBookmark(2, true);\n      treeWalk(editor.selection.getRng());\n      tinymce.activeEditor.fire('change');\n    },\n    onPostRender: handleActiveState\n  });\n});\n\n\n\n// WEBPACK FOOTER //\n// ./client/src/js/TeReoPlugin.js"],"sourceRoot":""}